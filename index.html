<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>moment-msdate.js</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="http://markitondemand.github.io/DataApis/Resources/bootstrap/bootstrap-2.3.2.css" />
    <link rel="stylesheet" href="http://markitondemand.github.io/DataApis/Resources/header.css" />
    <link rel="stylesheet" href="http://markitondemand.github.io/DataApis/Resources/footer.css" />
    <style type="text/css">
        table {
            font-size: 12px;
        }

        td { 
            font-family: Monaco,Menlo,Consolas,"Courier New",monospace;
            white-space: nowrap;
        }
    </style>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-29467710-1']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script>
</head>
<body>

<script type="text/javascript" src="http://markitondemand.github.io/DataApis/Resources/header.js"></script>

<div class="container">
    <div class="row">
        <div class="span12">
            <div class="hero-unit">
                <h2>moment-msdate.js <small>A Moment.js plugin for parsing OA dates</small></h2>

                <p><a href="http://momentjs.com/">Moment.js</a> is a javascript date library for parsing, validating, manipulating, and formatting dates.</p>

                <h3 class="page-header">Right Now</h3>
                <p>The time right now as an OLE Date is represented as <span id="todayMS"></span>. 
                    <br>This is equivalent to <span id="todayJS"></span>.
                    <br>
                    <small>Note: OLE Automation dates are unspecified, meaning they&rsquo;re based on the local timezone by default <span id="localTz"></span>.</small>
                </p>

                <p class="view"><a href="http://github.com/markitondemand/moment-msdate" class="btn btn-primary">View moment-msdate on GitHub</a></p>

                <p><iframe src="http://ghbtns.com/github-btn.html?user=markitondemand&amp;type=follow" allowtransparency="true" frameborder="0" scrolling="0" width="177px" height="20px"></iframe>
                <a href="https://twitter.com/markitondemand" class="twitter-follow-button" data-show-count="false">Follow @markitondemand</a></p>
            </div>
        </div>
    </div>
    <div class="row content">
        <div class="span5">
            <h3 class="page-header">About</h3>
                <p>An OLE Automation date, or &ldquo;MSDate&rdquo; as <a href="http://www.markitondemand.com">we</a> call it, is implemented as a floating-point number whose integral component is the number of days before or after midnight, 30 December 1899, and whose fractional component represents the time on that day divided by 24. For example, midnight, 31 December 1899 is represented by 1.0; 6 A.M., 1 January 1900 is represented by 2.25; midnight, 29 December 1899 is represented by -1.0; and 6 A.M., 29 December 1899 is represented by -1.25.</p>
                <p>Read more <a href="http://msdn.microsoft.com/en-us/library/dt80be78(v=vs.71).aspx">about OLE Automation on MSDN</a> (including <a href="http://msdn.microsoft.com/en-us/library/system.datetime.tooadate.aspx">DateTime.ToOADate</a> and <a href="http://msdn.microsoft.com/en-us/library/system.datetime.fromoadate.aspx">DateTime.FromOADate</a>).</p>
                <p>Some of <a href="http://dev.markitondemand.com">Market Data APIs</a> use MSDates in their response.</p>
        </div>
        <div class="span7">
            <h3 class="page-header">Tests</h3>
            
            <div id="tests">

            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="http://markitondemand.github.io/DataApis/Resources/footer.js"></script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!--https://bitbucket.org/pellepim/jstimezonedetect-->
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jstimezonedetect/1.0.4/jstz.min.js"></script>
<!--moment-->
<script type="text/javascript" src="lib/moment.js"></script>
<script type="text/javascript" src="lib/moment-timezone.js"></script>
<script type="text/javascript" src="lib/moment-timezone-data.js"></script>
<!--the plugin-->
<script type="text/javascript" src="moment-msdate.js"></script> 
<!--tests-->
<script type="text/javascript" src="tests.js"></script>  
<script type="text/javascript">

    $(function() {

        //helper
        var tzName = jstz.determine().name();

        //get current time as OA date
        var msDate = moment().toOADate();
        var momentDate = moment.fromOADate( msDate );

        $('#todayMS').text( msDate );
        $('#todayJS').text( momentDate );
        $('#localTz').text( '(' + tzName + ')' ).attr('title',moment().tz(tzName).format());

        loadTests();
    });

</script>

</body>
</html>